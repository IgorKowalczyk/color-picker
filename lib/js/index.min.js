/* (c) Igor Kowalczyk. All rights reserved. */

const body=document.body,getValues=()=>Array.from(textarea.value.split("\n")).filter(t=>!!t&t.length>3).map(t=>t.trim()),setValues=t=>{textarea.value=t.filter(t=>!!t&t.length>3).map(t=>t.trim()).join("\n"),textarea.rows=10},toJSON=t=>JSON.stringify(t,null,2),dataObj={values:[],add(t){this.values.push(t)},init(){btnEXPORT.addEventListener("click",()=>{const t=document.createElement("a"),e=JSON.stringify({palette:dataObj.values},null,2);t.setAttribute("href",`data:text/plain;charset=utf-8,${encodeURIComponent(e)}`),t.setAttribute("download","palette.json"),t.style.display="none",body.appendChild(t),t.click(),body.removeChild(t)},!1)}},tableObj={reset(){table.hasAttribute("data-active")?(table.textContent="",dataObj.values=[],table.appendChild(document.importNode(table_reset.content,!0))):table.setAttribute("data-active",!0)},add(t){t.forEach((t,e)=>{const a=document.importNode(template.content,!0),o=[...a.querySelectorAll("td")],[n,l,r,s,c,i]=o;[l.id,r.id,s.id]=[`rgb${e}`,`hex${e}`,`hsl${e}`];const{contrast:d}=t;n.dataset.tooltip=`black: ${d.black}\n white: ${d.white}`,n.style.color=d.white>4.5?"white":"black",n.style.background=t.rgb,n.textContent=t.default,l.textContent=t.rgb,r.textContent=t.hex,s.textContent=t.hsl,c.textContent=d.black,i.textContent=d.white,table.appendChild(a)}),btnEXPORT.removeAttribute("data-hide")}},colorUtil={hexString:({r:t,g:e,b:a})=>`#${t}${e}${a}`.toUpperCase(),rgbString:({r:t,g:e,b:a})=>`rgb(${t}, ${e}, ${a})`,hslString:({h:t,s:e,l:a})=>`hsl(${t}, ${e}%, ${a}%)`,rgbToHEX(t,{data:e}=!1){let[a,o,n]=t.match(/\d+/g);return[a,o,n]=[a,o,n].map(t=>parseInt(t,10).toString(16)),[a,o,n]=[a,o,n].map(t=>1===t.length?`0${t}`:t),e?[a,o,n]:colorUtil.hexString({r:a,g:o,b:n})},rgbToHSL(t,{data:e}=!1){let[a,o,n]=Array.isArray(t)?t:t.match(/\d+/g);[a,o,n]=[a,o,n].map(t=>t/255);let l=Math.min(a,o,n),r=Math.max(a,o,n),s=r-l,[c,i,d]=[0,0,.5*(r+l)];return 0!==s&&(c=r===a?(o-n)/s%6:r===o?(n-a)/s+2:(a-o)/s+4,i=s/(1-Math.abs(r+l-1))),[c,i,d]=[60*c,100*i,100*d],c<0&&(c+=360),[c,i,d]=[c,i,d].map(t=>parseInt(t)),e?[c,i,d]:colorUtil.hslString({h:c,s:i,l:d})},hslToRGB(t,{data:e}=!1){let[a,o,n]=t.match(/\d+/g);[a,o,n]=[a/60,o/100,n/100];let l=o*(1-Math.abs(2*n-1)),r=l*(1-Math.abs(a%2-1)),s=n-l/2;[l,r,s]=[l+s,r+s,s].map(t=>Math.round(255*t)),[l,r,s]=[l,r,s].map(t=>t<1?0:t);let[c,i,d]=[[l,r,s],[r,l,s],[s,l,r],[s,r,l],[r,s,l],[l,s,r]][Math.floor(a)%6];return e?[c,i,d]:colorUtil.rgbString({r:c,g:i,b:d})},hslToHEX(t,{data:e}=!1){let[a,o,n]=colorUtil.hslToRGB(t,{data:!0});return[a,o,n]=[a,o,n].map(t=>parseInt(t,10).toString(16)),[a,o,n]=[a,o,n].map(t=>1===t.length?`0${t}`:t),e?[a,o,n]:colorUtil.hexString({r:a,g:o,b:n})},hexToRGB(t,{data:e}=!1){const a=`0x${t.replace("#","")}`,[o,n,l]=[a>>16,a>>8,a].map(t=>255&t);return e?[o,n,l]:colorUtil.rgbString({r:o,g:n,b:l})},hexToHSL(t){const[e,a,o]=colorUtil.hexToRGB(t,{data:!0});return colorUtil.rgbToHSL([e,a,o])},getContrast(t,e){const a=t=>{let[e,a,o]=t.match(/\d+/g);return[e,a,o]=[e,a,o].map(t=>(t=>t<.04045?t/12.92:((t+.055)/1.055)**2.4)(t/255)),[e,a,o]=[.2126*e,.7152*a,.0722*o],[e,a,o].reduce((t,e)=>t+e)},[o,n]=[a(t),a(e)],l=(Math.max(o,n)+.05)/(Math.min(o,n)+.05);return null!=l?l.toPrecision(l>=10?4:3):o===n?1:21}},submit=()=>{tableObj.reset();const t=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,e=/^rgb\((\s*\d{1,3}\s*),(\s*\d{1,3}\s*),(\s*\d{1,3}\s*)\)$/i,a=/^hsl\((\s*\d{1,3}\s*),(\s*\d{1,3}%\s*),(\s*\d{1,3}%\s*)\)$/i,{hexToRGB:o,hexToHSL:n,rgbToHEX:l,rgbToHSL:r,hslToRGB:s,hslToHEX:c,getContrast:i}=colorUtil,d=getValues();textarea.value=d.join("\n"),d.forEach(d=>{t.test(d)&&d.length<6&&(d="#"+[...d.slice(1)].map(t=>`${t}${t}`).join(""));const[m,h,g,u]=t.test(d)?["HEX",o(d),d,n(d)]:e.test(d)?["RGB",d,l(d),r(d)]:a.test(d)?["HSL",s(d),c(d),d]:"";dataObj.add({default:m,rgb:h,hex:g,hsl:u,contrast:{black:i(h,"rgb(0,0,0)"),white:i(h,"rgb(255,255,255)")}})}),tableObj.add(dataObj.values)},copyObj={copyText(t){const e=document.body,a=document.createElement("textarea");a.value=t,a.setAttribute("readonly",""),a.style.position="absolute",a.style.left="-9999px",e.appendChild(a);const o=document.getSelection().rangeCount>0&&document.getSelection().getRangeAt(0);a.select(),document.execCommand("copy"),e.removeChild(a),o&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(o))},copyAnim(t){(t=document.getElementById(t)).className="box pulse",t.addEventListener("animationend",()=>{t.className="box"},!1)}};button.addEventListener("click",()=>{submit()},!1),table.addEventListener("click",t=>{t.target&&"TD"==t.target.nodeName&&(copyObj.copyAnim(t.target.id),copyObj.copyText(t.target.textContent))},!1);const colorArray=["#E5F2EE","rgb(171, 223, 207)","#78CBB4","#4FB79D","hsl(166, 53%, 41%)","#1B9077","#0C7C66","#036855","#005545","#004136","hsl(170, 100%, 8%)","#001A15","rgb(242, 229, 229)","#F2C2C3","#F0A0A1","rgb(236, 127, 129)","#E66467","hsl(357, 68%, 58%)","hsl(357, 61%, 51%)","#BE2A31","#A41E25","#7F131A","#500B10","#1A0305","#F2EAE5","#EFCEBC","#EAB293","#E2986E","#D8814F","hsl(22, 57%, 50%)","#B75D22","#A04E14","#843F0A","#632F05","#3E1F01","#1A0D00","hsl(38, 34%, 92%)","#F0DBAE","#E7C878","rgb(217, 179, 72)","#C49D21","#AB8606","hsl(47, 100%, 28%)","#765E00","#5C4A00","#443700","#2E2600","hsl(48, 100%, 5%)","#EDF2E3","rgb(204, 235, 169)","#99D971","hsl(105, 53%, 51%)","#2EB01E","#069A08","#008310","#006D16","#005817","#004214","#002E0F","#001A09"];setValues(colorArray),dataObj.init(),submit();const toggletheme=document.querySelector('.theme-switch input[type="checkbox"]'),currenttheme=localStorage.getItem("theme"),meta=document.querySelector('meta[name="theme-color"]');function switchtheme(t){t.target.checked?(document.documentElement.setAttribute("data-theme","dark"),meta.setAttribute("content","#222"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),meta.setAttribute("content","#ffffff"),localStorage.setItem("theme","light"))}currenttheme&&(document.documentElement.setAttribute("data-theme",currenttheme),"dark"===currenttheme&&(toggletheme.checked=!0)),toggletheme.addEventListener("change",switchtheme,!1);var scrollposition=window.scrollY,logocontainer=document.getElementsByClassName("nav")[0];window.addEventListener("scroll",function(){(scrollposition=window.scrollY)>=40?logocontainer.classList.add("nav-scrolled"):logocontainer.classList.remove("nav-scrolled")}),function(){var t=document.getElementById("close"),e=document.getElementById("info");null===sessionStorage.getItem("info")?t.addEventListener("click",()=>{e.classList.add("info-hide"),setTimeout(()=>{e.classList.add("info-hide-margin")},500),sessionStorage.setItem("info","true")}):e.style.display="none"}();